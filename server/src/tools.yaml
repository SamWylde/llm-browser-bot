# Common definitions
_common:
  tabId: &tabId
    type: string
    description: Target tab ID

  selectorAndXpath: &selectorAndXpath
    selector:
      type: string
      description: The CSS selector to find a target Element for the action (uses first matching element)
    xpath:
      type: string
      description: An XPath expression to find a target Element for the action (alternative to selector, uses first matching element)

  oneOfSelectorOrXpath: &oneOfSelectorOrXpath
    oneOf:
      - required: [selector]
      - required: [xpath]

tools:
  list_tabs:
    description: List all connected browser tabs

  tab_detail:
    description: Get detailed information about a specific tab
    required: [tabId]
    properties:
      tabId: *tabId

  navigate:
    description: Navigate browser tab to specified URL
    required: [tabId, url]
    properties:
      tabId: *tabId
      url:
        type: string
        format: url
        description: URL to navigate to
      timeout:
        type: number
        description: Navigation timeout in milliseconds
        default: 30000

  back:
    description: Navigate back in browser history
    required: [tabId]
    properties:
      tabId: *tabId

  forward:
    description: Navigate forward in browser history
    required: [tabId]
    properties:
      tabId: *tabId

  click:
    description: >-
      Click on a page element using CSS selector or XPath. Only the first 
      matching element will be clicked. Returns the unique selector of the 
      clicked element. Note: May experience delays if LLM Browser Bot DevTools panel 
      is not the active tab.
    required: [tabId]
    properties:
      tabId: *tabId
      <<: *selectorAndXpath
      timeout:
        type: number
        description: Command timeout in milliseconds (default 8000)
    <<: *oneOfSelectorOrXpath

  hover:
    description: >-
      Hover over a page element using CSS selector or XPath. Only the first 
      matching element will be hovered. Returns the unique selector of the 
      hovered element. Note: May experience delays if LLM Browser Bot DevTools panel 
      is not the active tab.
    required: [tabId]
    <<: *oneOfSelectorOrXpath
    properties:
      tabId: *tabId
      <<: *selectorAndXpath
      timeout:
        type: number
        description: Command timeout in milliseconds (default 5000)

  focus:
    description: >-
      Set focus on a page element using CSS selector or XPath. Only the first 
      matching element will be focused. Returns the unique selector of the 
      focused element. Useful for form inputs, buttons, and other interactive 
      elements.
    required: [tabId]
    <<: *oneOfSelectorOrXpath
    properties:
      tabId: *tabId
      <<: *selectorAndXpath
      timeout:
        type: number
        description: Command timeout in milliseconds (default 5000)

  blur:
    description: >-
      Remove focus (blur) from a page element using CSS selector or XPath. Only 
      the first matching element will be blurred. Returns the unique selector of 
      the blurred element. Also removes focus from document.activeElement if 
      different.
    required: [tabId]
    <<: *oneOfSelectorOrXpath
    properties:
      tabId: *tabId
      <<: *selectorAndXpath
      timeout:
        type: number
        description: Command timeout in milliseconds (default 5000)

  fill:
    description: >-
      Fill an input field with a value using CSS selector or XPath. Only the 
      first matching element will be filled. Returns the unique selector of 
      the filled element.
    required: [tabId, value]
    <<: *oneOfSelectorOrXpath
    properties:
      tabId: *tabId
      <<: *selectorAndXpath
      value:
        type: string
        description: Value to fill in the input
      timeout:
        type: number
        description: Command timeout in milliseconds (default 5000)

  paste:
    description: >-
      Paste text into an input field or contenteditable element at the current 
      cursor position. Simulates a paste action using insertText command and 
      clipboard events. Returns success status.
    required: [tabId, value]
    <<: *oneOfSelectorOrXpath
    properties:
      tabId: *tabId
      <<: *selectorAndXpath
      value:
        type: string
        description: Text content to paste
      timeout:
        type: number
        description: Command timeout in milliseconds (default 5000)

  clear:
    description: >-
      Clear the value of an input field or contenteditable element. 
      Resets the value to empty string and triggers input/change events. 
      Useful for resetting a field before typing.
    required: [tabId]
    <<: *oneOfSelectorOrXpath
    properties:
      tabId: *tabId
      <<: *selectorAndXpath
      timeout:
        type: number
        description: Command timeout in milliseconds (default 5000)

  select:
    description: >-
      Select an option from an HTML <select> dropdown element using CSS 
      selector or XPath. Only the first matching select element will be used. 
      Returns the unique selector of the select element. Note: Only works with 
      native HTML select elements, not custom dropdowns.
    required: [tabId, value]
    <<: *oneOfSelectorOrXpath
    properties:
      tabId: *tabId
      <<: *selectorAndXpath
      value:
        type: string
        description: Value attribute of the option to select
      timeout:
        type: number
        description: Command timeout in milliseconds (default 5000)

  keypress:
    description: >-
      Send a keypress event to the current tab or a specific element. Uses 
      Chrome DevTools Protocol for proper key simulation including navigation 
      keys (Tab, PageDown, arrows) and function keys. When delay > 500ms, 
      automatically simulates holding the key down with repeated events.
    required: [tabId, key]
    properties:
      tabId: *tabId
      key:
        type: string
        description: >-
          The key combination to press. Can be a single key (e.g., "a", 
          "Enter", "Tab", "PageDown", "F5") or a combination with modifiers 
          (e.g., "Control+a", "Shift+Tab", "Alt+F4", "Meta+Shift+p"). 
          Special keys: Enter, Tab, Delete, Backspace, Escape, Space, 
          ArrowUp/Down/Left/Right, PageUp/Down, Home, End, Insert, F1-F12. 
          Modifiers: Control (or Ctrl), Shift, Alt, Meta (or Cmd on Mac)
      <<: *selectorAndXpath
      delay:
        type: number
        description: >-
          Delay in milliseconds between keydown and keyup events. Default: 
          50ms. Range: 0-60000ms. When > 500ms, simulates holding the key 
          down with auto-repeat
        default: 50
        minimum: 0
        maximum: 60000
      timeout:
        type: number
        description: >-
          Command timeout in milliseconds. Default: 5000ms. Automatically 
          extended for long delays
        minimum: 1000
        maximum: 70000

  screenshot:
    description: >-
      Capture a screenshot of the page or specific element using CSS selector 
      or XPath. When a selector/xpath is provided, only the first matching 
      element will be captured. Returns the unique selector of the captured 
      element if applicable.
    required: [tabId]
    properties:
      tabId: *tabId
      <<: *selectorAndXpath
      scale:
        type: number
        description: Scale factor (0.1-1.0) to reduce screenshot size (default 0.3)
        default: 0.3
        minimum: 0.1
        maximum: 1
      format:
        type: string
        description: Image format (default webp for best compression)
        default: webp
        enum: [webp, jpeg, png]
      quality:
        type: number
        description: Compression quality for webp/jpeg (0.1-1.0, default 0.85)
        default: 0.85
        minimum: 0.1
        maximum: 1
      timeout:
        type: number
        description: Command timeout in milliseconds (default 5000)


  dom:
    description: >-
      Get outerHTML of the body or a specific element using CSS selector or 
      XPath. When a selector/xpath is provided, only the first matching 
      element will be used. Returns the unique selector of the element if 
      applicable.
    required: [tabId]
    properties:
      tabId: *tabId
      <<: *selectorAndXpath

  elements:
    description: >-
      Query all elements matching a CSS selector or XPath and get detailed 
      information about each element. Use the visible parameter to filter 
      elements by visibility status.
    required: [tabId]
    <<: *oneOfSelectorOrXpath
    properties:
      tabId: *tabId
      <<: *selectorAndXpath
      visible:
        type: string
        description: Filter elements by visibility (true = only visible, false = only hidden, all = all elements)
        default: "all"
        enum: ["true", "false", "all"]

  elements_from_point:
    description: Get information about all elements at a specific coordinate in the viewport
    required: [tabId, x, y]
    properties:
      tabId: *tabId
      x:
        type: number
        description: X coordinate relative to the viewport
      y:
        type: number
        description: Y coordinate relative to the viewport

  console_logs:
    description: Get console logs from a browser tab
    required: [tabId]
    properties:
      tabId: *tabId
      before:
        type: string
        description: Get logs before this timestamp (for pagination)
      limit:
        type: integer
        description: Maximum number of logs to return
        default: 100
        minimum: 1
        maximum: 500
      level:
        type: string
        description: Filter logs by level (log, info, warn, error, debug, trace, table, group, groupCollapsed, groupEnd)
        enum: ["log", "info", "warn", "error", "debug", "trace", "table", "group", "groupCollapsed", "groupEnd"]

  new_tab:
    description: >-
      Opens a new browser tab with the LLM Browser Bot MCP usage documentation page. 
      The page will automatically connect to the LLM Browser Bot server. Returns the 
      tab ID of the newly opened tab once it connects.
    properties:
      browser:
        type: string
        description: >-
          Optional browser to use. Supported values: chrome, edge, brave, opera, vivaldi.
          If not specified, uses the system default browser.
        enum: ["chrome", "edge", "brave", "opera", "vivaldi"]

  close:
    description: >-
      Closes a browser tab. The tab will be immediately closed and removed 
      from the connected tabs list.
    required: [tabId]
    properties:
      tabId: *tabId

  reload:
    description: >-
      Reloads the current page in the browser tab. Performs a standard page 
      reload similar to pressing F5 or clicking the browser's refresh button.
    required: [tabId]
    properties:
      tabId: *tabId

  show:
    description: >-
      Brings the browser tab to the front and focuses it. This will switch to 
      the tab's window and make it the active tab. Useful for directing user 
      attention to a specific tab when managing multiple browser tabs.
    required: [tabId]
    properties:
      tabId: *tabId

  scroll:
    description: >-
      Scroll the page. Supports three modes: (1) direction-based scrolling 
      by full page height ("up" or "down"), (2) scroll element into view 
      using CSS selector or XPath, or (3) scroll to specific x/y coordinates.
    required: [tabId]
    properties:
      tabId: *tabId
      direction:
        type: string
        description: Scroll by full page height ("up" or "down")
        enum: [up, down]
      <<: *selectorAndXpath
      x:
        type: number
        description: X coordinate to scroll to
      y:
        type: number
        description: Y coordinate to scroll to
      behavior:
        type: string
        description: Scroll behavior
        default: smooth
        enum: [auto, smooth]
      timeout:
        type: number
        description: Command timeout in milliseconds (default 5000)

  evaluate:
    description: >-
      Execute arbitrary JavaScript code in the page context. Supports async/await 
      for asynchronous operations. Returns serialized result with circular 
      reference handling and DOM element representation.
    required: [tabId, code]
    properties:
      tabId: *tabId
      code:
        type: string
        description: JavaScript code to execute (can use async/await)
      timeout:
        type: number
        description: Command timeout in milliseconds (default 5000)

  get_attribute:
    description: >-
      Get a specific attribute value from an element. Returns the attribute 
      value and whether it exists on the element.
    required: [tabId, attribute]
    <<: *oneOfSelectorOrXpath
    properties:
      tabId: *tabId
      <<: *selectorAndXpath
      attribute:
        type: string
        description: Name of the attribute to get

  get_computed_style:
    description: >-
      Get computed CSS styles for an element. Can specify which properties 
      to return, or returns common properties by default (display, visibility, 
      opacity, position, width, height, margin, padding, color, etc.).
    required: [tabId]
    <<: *oneOfSelectorOrXpath
    properties:
      tabId: *tabId
      <<: *selectorAndXpath
      properties:
        type: array
        items:
          type: string
        description: >-
          CSS property names to get. If not specified, returns common 
          properties like display, visibility, opacity, position, etc.

  get_text:
    description: >-
      Extract visible text content from an element. Uses innerText which 
      respects CSS visibility. If no selector/xpath provided, returns all 
      visible text from the page body.
    required: [tabId]
    properties:
      tabId: *tabId
      <<: *selectorAndXpath

  wait_for_element:
    description: >-
      Wait for an element to appear in the DOM with configurable timeout 
      and visibility check. Polls every 100ms until element is found or 
      timeout is reached. Timeout is auto-extended on the command level.
    required: [tabId]
    <<: *oneOfSelectorOrXpath
    properties:
      tabId: *tabId
      <<: *selectorAndXpath
      timeout:
        type: number
        description: Maximum time to wait in milliseconds
        default: 5000
        minimum: 100
        maximum: 60000
      visible:
        type: boolean
        description: If true, wait for element to be visible, not just in DOM
        default: true

  type:
    description: >-
      Human-like character-by-character typing with configurable delay between 
      keystrokes. Simulates keydown, keypress, input, and keyup events for 
      each character. If no selector provided, types to currently focused element.
      Timeout is auto-extended based on text length and delay.
    required: [tabId, text]
    properties:
      tabId: *tabId
      <<: *selectorAndXpath
      text:
        type: string
        description: Text to type character by character
      delay:
        type: number
        description: Delay in milliseconds between keystrokes
        default: 50
        minimum: 0
        maximum: 1000
      timeout:
        type: number
        description: Command timeout in milliseconds (default calculated based on text length)

  select_text:
    description: >-
      Select text within an element. Works with input/textarea elements 
      using setSelectionRange, and regular elements using Range API. 
      Returns the selected text.
    required: [tabId]
    <<: *oneOfSelectorOrXpath
    properties:
      tabId: *tabId
      <<: *selectorAndXpath
      start:
        type: integer
        description: Start character index (0-based)
        default: 0
      end:
        type: integer
        description: End character index (defaults to end of text)

  get_selected_text:
    description: >-
      Get the currently selected text on the page. Returns the selection 
      as a string along with its length.
    required: [tabId]
    properties:
      tabId: *tabId

  # ============ AI-FOCUSED TOOLS ============

  page_structure:
    description: >-
      Get a hierarchical summary of the page structure optimized for LLM 
      understanding. Returns headings hierarchy, navigation areas with links, 
      forms with fields, main content area, ARIA landmarks, and counts of 
      interactive elements. Much more useful than raw DOM for AI comprehension.
    required: [tabId]
    properties:
      tabId: *tabId

  labeled_screenshot:
    description: >-
      Add numbered labels to all visible interactive elements on the page. 
      After calling this, take a screenshot to capture the labeled view. 
      Returns a list of elements with their index numbers, selectors, and 
      bounding boxes. Use clear_labels to remove overlays when done.
    required: [tabId]
    properties:
      tabId: *tabId

  clear_labels:
    description: >-
      Remove the numbered label overlays created by labeled_screenshot.
    required: [tabId]
    properties:
      tabId: *tabId

  accessibility_tree:
    description: >-
      Get the accessibility tree for the page or a specific element. Returns 
      a hierarchical structure with roles, accessible names, and states - 
      similar to what screen readers see. Useful for understanding page 
      structure without visual context.
    required: [tabId]
    properties:
      tabId: *tabId
      <<: *selectorAndXpath
      maxDepth:
        type: integer
        description: Maximum depth to traverse (default 5)
        default: 5
        minimum: 1
        maximum: 10
      maxNodes:
        type: integer
        description: Maximum number of nodes to return (default 500)
        default: 500
        minimum: 10
        maximum: 2000
